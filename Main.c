#include<stdio.h>
#include<windows.h>

extern int Laberinto(char *mat, int x, int y);
void instrucciones();
void reiniciar(char lab[15][15], char aux[15][15]);

int main(){
    int res, x = 1, y = 1, auxX = 1, auxY = 1;
    char mov;
    char labe[15][15] = {{'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'}, {'#','F','.','#','.','.','.','#','#','#','.','.','#','.','#'},
                        {'#','#','.','#','#','#','.','.','.','#','#','.','#','.','#'}, {'#','#','.','.','.','.','.','#','.','.','.','.','.','.','#'},
                        {'#','#','.','#','#','.','#','#','.','#','.','#','#','.','#'}, {'#','.','.','.','#','#','.','.','.','#','.','#','#','.','#'},
                        {'#','.','#','#','.','.','.','#','#','#','.','#','.','.','#'}, {'#','.','.','.','.','#','.','.','.','.','.','#','.','#','#'},
                        {'#','#','#','.','.','#','.','#','#','#','#','#','.','#','#'}, {'#','#','#','.','#','#','#','.','.','#','.','.','.','#','#'},
                        {'#','.','.','.','#','#','.','#','.','#','#','#','.','#','#'}, {'#','.','.','#','.','.','.','#','.','.','.','#','.','.','#'},
                        {'#','.','#','#','.','#','.','.','.','#','.','#','#','.','#'}, {'#','.','.','.','.','#','#','#','#','.','.','.','.','X','#'}, 
                        {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'}
                    };
     char aux[15][15] = {{'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'}, {'#','F','.','#','.','.','.','#','#','#','.','.','#','.','#'},
                        {'#','#','.','#','#','#','.','.','.','#','#','.','#','.','#'}, {'#','#','.','.','.','.','.','#','.','.','.','.','.','.','#'},
                        {'#','#','.','#','#','.','#','#','.','#','.','#','#','.','#'}, {'#','.','.','.','#','#','.','.','.','#','.','#','#','.','#'},
                        {'#','.','#','#','.','.','.','#','#','#','.','#','.','.','#'}, {'#','.','.','.','.','#','.','.','.','.','.','#','.','#','#'},
                        {'#','#','#','.','.','#','.','#','#','#','#','#','.','#','#'}, {'#','#','#','.','#','#','#','.','.','#','.','.','.','#','#'},
                        {'#','.','.','.','#','#','.','#','.','#','#','#','.','#','#'}, {'#','.','.','#','.','.','.','#','.','.','.','#','.','.','#'},
                        {'#','.','#','#','.','#','.','.','.','#','.','#','#','.','#'}, {'#','.','.','.','.','#','#','#','#','.','.','.','.','X','#'}, 
                        {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'}
                    };

    instrucciones();

    for(int i = 0; i < 15; i++){
        printf("\n");
        for(int j = 0; j < 15; j++)
        {
            printf("%c ", labe[i][j]);
        }
    }
    printf("\n\n");

    do{
        res = 0;
        printf("\nMovimiento --> ");
        fflush(stdin);
        scanf("%c", &mov);
        switch(mov){
            case 'W':
                auxX = x;
                x = x - 1;
                break;
            case 'A':
                auxY = y;
                y = y - 1;
                break;
            case 'S':
                auxX = x;
                x = x + 1;
                break;
            case 'D':
                auxY = y;
                y = y + 1;
                break;
            case 'w':
                auxX = x;
                x = x - 1;
                break;
            case 'a':
                auxY = y;
                y = y - 1;  
                break;
            case 's':
                auxX = x;
                x = x + 1;
                break;
            case 'd':
                auxY = y;
                y = y + 1;
                break;
        }
        if((x >= 0 && x < 16) && (y >= 0 && y < 16)){
            res = Laberinto(&labe[0][0], x, y);
        } else{
            if((x < 0) || (x > 15)){
                x = auxX;
            } else{
                if((y < 0) || (y > 15)){
                    y = auxY;
                } 
            }
            //res = Laberinto(&labe[0][0], x, y);
        }

        printf("\n\n%d\n\n", res);

        if(res == 1){
            printf("\nReiniciando...\n");
            Sleep(1000);
            system("cls");
            reiniciar(labe, aux);
            res = 0;
            x = 1;
            y = 1;
            auxX = x;
            auxY = y;
        }
    } while(res != 10);

    return 0;
}

void instrucciones(){
    printf("\nInstrucciones del juego:\n");
    printf("\n1.El juego se basa en un laberinto de 15x15.");
    printf("\n2.La ficha del jugador es la letra F.");
    printf("\n3.La meta es llegar al punto X.");
    printf("\n4.Te puedes mover usando las teclas W,A,S,D.");
    printf("\n5.Puedes reiniciar el juego con la tecla r.");
    printf("\n6.Puedes salir del juego con la letra q.");
    printf("\n7.Los simbolos # son paredes que no se pueden atravesar.");
    printf("\n8.Los puntos son los espacios por donde puedes moverte.\n\n");
}

void reiniciar(char lab[15][15], char aux[15][15]){
    for(int i = 0; i < 15; i++){
        for(int j = 0; j < 15; j++)
        {
            lab[i][j] = aux[i][j];
        }
    }
    printf("\n");
    instrucciones();
    for(int i = 0; i < 15; i++){
        printf("\n");
        for(int j = 0; j < 15; j++)
        {
            printf("%c ", lab[i][j]);
        }
    }
    printf("\n\n");
}